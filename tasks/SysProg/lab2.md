# Задания к работе №2 по Системному программированию.

Все задания реализуются на языке программирования C++ (стандарт C++14 и выше).
Реализованные  в  заданиях  приложения  не  должны  завершаться  аварийно;  все
возникающие исключительные ситуации должны быть перехвачены и обработаны.
Во всех заданиях запрещено пользоваться функциями, позволяющими завершить
выполнение приложения из произвольной точки выполнения.
Во  всех  заданиях  при  реализации  необходимо  разделять  контексты  работы  с
данными (поиск, сортировка, добавление/удаление, модификация и т. п.) и отправка
данных в поток вывода / выгрузка данных из потока ввода.
Во всех заданиях все вводимые (с консоли, файла, командной строки) пользователем
данные  должны  (если  не  сказано  обратное)  быть  подвергнуты  валидации  в
соответствии с типом валидируемых данных.
Во  всех  заданиях  необходимо  контролировать  ситуации  с  невозможностью
[пере]выделения памяти; во всех заданиях необходимо корректно освобождать всю
выделенную динамическую память.
Все ошибки, связанные с операциями открытия файла, должны быть обработаны;
все открытые файлы должны быть закрыты.

## 1. Реализация класса логгера
### Описание:
Разработать класс Logger, который предоставляет функциональность логирования с возможностью гибкой настройки;

### Функциональные требования:
- Поддержка добавления обработчиков вывода логов (например, файловые потоки);
- Возможность настройки уровня логирования (CRITICAL -> ERROR -> WARNING -> INFO -> DEBUG);
- Отправка сообщений в лог с заданным уровнем логирования;
- Реализация паттерна "Строитель" (Builder) для создания экземпляра логгера;
- Возможность закрытия логгера и корректного завершения работы.


## 2. Создание генератора и анализатора логов
### Описание:
Реализовать многопоточную систему генерации и анализа логов TCP-трафика с использованием паттерна "производитель-потребитель" и механизмов синхронизации.

### Функциональные требования:

Все генераторы пишут в одну и ту же очередь данных, оттуда каждый из запущенных экземпляров анализатора логов конкурентно забирает данные и составляет локальную статистику (для каждого экземпляра анализатора свою). В конце локальные статистики объединяются в глобальную.

Генератор логов:
- Создает логи сетевого трафика с различными событиями:
- Подключение;
- Отправка данных;
- Получение данных;
- Отключение (запланированное или внезапное);
- Работает в многопоточном режиме, имитируя несколько независимых источников логов;
- Использует Logger для записи логов.


Анализатор логов:
- Обрабатывает логи TCP-трафика, агрегируя информацию по IP-адресам;
- Работает в многопоточном режиме, синхронизируясь с генератором логов;
- Предоставляет возможность в режиме реального времени получить информацию о трафике конкретного IP адреса. (Запрашивает с каждого экземпляра анализатора текущую статистику для конкретного IP и объединяет ее в одну общую)<br>
- Сохраняет статистику для каждого IP адреса:
    - Общее количество отправленных данных;
    - Общее количество полученных данных;
    - Количество установленных соединений;
    - Список подключенных IP-адресов с данными об обмене;
    - Для каждого подключенного IP адреса делает разбивку по портам назначения (не обязательно будет плюсом).

### Доп. информация
Рекомендуется использовать <i>std::map</i> для агрегации информации по IP адресам.<br>
Структуры данных для хранения информации о TCP трафике:
```c
struct tcp_traffic_pkg {
    in_port_t src_port;
    in_addr_t dst_addr;
    in_port_t dst_port;
    const size_t sz;
};

struct tcp_traffic {
    in_addr_t src_addr;
    struct tcp_traffic_pkg* pkgs;
    size_t pkgs_sz;
};
```

## 3. Чат с использованием разделяемой памяти
### Описание:
Реализовать клиент-серверное приложение для обмена сообщениями с использованием разделяемой памяти и семафоров.
### Функциональные требования:
Сервер:<br>
- Обрабатывает несколько клиентов одновременно;
- Позволяет переключаться между активными чатами;
- Сохраняет историю переписки для каждого клиента;
- При подключении клиента посылает ему всю переписку с ним;
- Использует Logger для записи логов.


Клиент:
- Подключается к серверу;
- В случае успешного подключения начинает переписку;
- Использует Logger для записи логов.

### Технические требования:
- Межпроцессное взаимодействие через разделяемую память и семафоры;
- Гарантированная синхронизация потоков для корректной работы с памятью.


## 4. Управление лифтами
### Описание:
Создать систему управления несколькими лифтами в многоэтажном здании с возможностью логирования событий.

### Функциональные требования:
- Генерация вызовов лифта с случайным числом людей, случайными этажами отправления и назначения;
- Группировка пассажиров, если у них совпадает маршрут;
- Логирование всех действий лифта с помощью Logger;
- Поддержка произвольного количества лифтов (минимум 1);
- Поддержка произвольного количества этажей (минимум 2);
- Лифты имеют различную вместимость (от 2 до 8 человек);
- Временны́е задержки на выполнение операций:
    - Открытие дверей – 1 тик;
    - Посадка пассажиров – 1 тик;
    - Закрытие дверей – 1 тик;
    - Перемещение между этажами – 2 тика;
- Статистика по завершении работы:<br>
    - Количество перевезённых пассажиров каждым лифтом;
    - Общее количество перевезённых пассажиров;
    - Количество этажей, пройденных каждым лифтом;
    - Общее количество пройденных этажей;
    - Среднее время ожидания лифта (в тиках).